<Page x:Class="UP._02._01_Vybornov.Pages.EventDetailsPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
      mc:Ignorable="d" 
      Title="Детали мероприятия"
      FontFamily="Comic Sans MS">

    <Page.Resources>
        <SolidColorBrush x:Key="PrimaryBackground" Color="#FFFFFF"/>
        <SolidColorBrush x:Key="SecondaryBackground" Color="#ABCFCE"/>
        <SolidColorBrush x:Key="AccentColor" Color="#546F94"/>
        <SolidColorBrush x:Key="TextColor" Color="#000000"/>
        <SolidColorBrush x:Key="SecondaryTextColor" Color="#666666"/>
        <SolidColorBrush x:Key="BorderColor" Color="#DDDDDD"/>
        <SolidColorBrush x:Key="SuccessColor" Color="#4CAF50"/>
        <SolidColorBrush x:Key="WarningColor" Color="#FF9800"/>
        <SolidColorBrush x:Key="ErrorColor" Color="#F44336"/>

        <Style x:Key="BackButtonStyle" TargetType="Button">
            <Setter Property="Margin" Value="5"/>
            <Setter Property="Padding" Value="10,5"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Background" Value="{StaticResource SecondaryBackground}"/>
            <Setter Property="Foreground" Value="{StaticResource TextColor}"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="BorderThickness" Value="0"/>
        </Style>

        <Style x:Key="ActionButtonStyle" TargetType="Button">
            <Setter Property="Margin" Value="0,5,0,0"/>
            <Setter Property="Padding" Value="15,8"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="HorizontalAlignment" Value="Left"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="BorderThickness" Value="0"/>
        </Style>

        <Style x:Key="ComboBoxStyle" TargetType="ComboBox">
            <Setter Property="Margin" Value="0,5,0,10"/>
            <Setter Property="Padding" Value="10"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderColor}"/>
            <Setter Property="BorderThickness" Value="1"/>
        </Style>

        <Style x:Key="ListBoxStyle" TargetType="ListBox">
            <Setter Property="Margin" Value="0,5,0,10"/>
            <Setter Property="MaxHeight" Value="150"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderColor}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Background" Value="White"/>
        </Style>
    </Page.Resources>

    <Grid Background="{StaticResource SecondaryBackground}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Шапка -->
        <Border Grid.Row="0" 
                Background="{StaticResource PrimaryBackground}" 
                Padding="15"
                BorderBrush="{StaticResource BorderColor}"
                BorderThickness="0,0,0,1">
            <DockPanel>
                <Button x:Name="BackButton"
                        Content="← Назад к мероприятиям"
                        Style="{StaticResource BackButtonStyle}"
                        Padding="15,8"
                        Click="BackButton_Click"
                        DockPanel.Dock="Left"/>

                <TextBlock x:Name="PageTitleTextBlock" 
                          Text="Детали мероприятия" 
                          FontSize="20" 
                          FontWeight="Bold"
                          HorizontalAlignment="Center"
                          VerticalAlignment="Center"/>
            </DockPanel>
        </Border>

        <!-- Контент -->
        <ScrollViewer Grid.Row="1" 
                     VerticalScrollBarVisibility="Auto"
                     Padding="20">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="450"/>
                </Grid.ColumnDefinitions>

                <!-- Основная информация -->
                <StackPanel Grid.Column="0" Margin="0,0,20,0">
                    <!-- Статус регистрации -->
                    <Border x:Name="RegistrationStatusBorder"
                            Background="{StaticResource SuccessColor}"
                            CornerRadius="6"
                            Padding="15"
                            Margin="0,0,0,15"
                            Visibility="Collapsed">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="✓"
                                      FontSize="20"
                                      FontWeight="Bold"
                                      Foreground="White"
                                      Margin="0,0,10,0"/>
                            <TextBlock x:Name="RegistrationStatusText"
                                      FontSize="14"
                                      FontWeight="Bold"
                                      Foreground="White"
                                      VerticalAlignment="Center"/>
                        </StackPanel>
                    </Border>

                    <Border Background="#F8F8F8"
                            BorderBrush="{StaticResource BorderColor}"
                            BorderThickness="1"
                            CornerRadius="6"
                            Padding="15"
                            Margin="0,10,0,10">
                        <StackPanel>
                            <!-- Заголовок мероприятия -->
                            <TextBlock x:Name="EventTitleTextBlock" 
                                      FontSize="20"
                                      FontWeight="Bold"
                                      Foreground="{StaticResource TextColor}"
                                      Margin="0,0,0,15"
                                      TextWrapping="Wrap"
                                      LineHeight="1.3"/>

                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <!-- Логотип -->
                                <Border Grid.Column="0" 
                                        Width="150" 
                                        Height="150"
                                        Background="{StaticResource SecondaryBackground}"
                                        CornerRadius="8"
                                        Margin="0,0,20,0">
                                    <Image x:Name="EventLogoImage"
                                           Stretch="Uniform"
                                           HorizontalAlignment="Center"
                                           VerticalAlignment="Center"/>
                                </Border>

                                <!-- Детали -->
                                <StackPanel Grid.Column="1">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="Направление:" 
                                                  FontSize="14"
                                                  FontWeight="SemiBold"
                                                  Foreground="{StaticResource TextColor}"
                                                  Margin="0,5,10,5"
                                                  Width="150"/>
                                        <TextBlock x:Name="DirectionTextBlock" 
                                                  FontSize="14"
                                                  Foreground="{StaticResource TextColor}"
                                                  Margin="0,5,0,5"
                                                  TextWrapping="Wrap"
                                                  FontWeight="SemiBold"/>
                                    </StackPanel>

                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="Дата проведения:" 
                                                  FontSize="14"
                                                  FontWeight="SemiBold"
                                                  Foreground="{StaticResource TextColor}"
                                                  Margin="0,5,10,5"
                                                  Width="150"/>
                                        <TextBlock x:Name="DateTextBlock" 
                                                  FontSize="14"
                                                  Foreground="{StaticResource TextColor}"
                                                  Margin="0,5,0,5"
                                                  TextWrapping="Wrap"
                                                  FontWeight="SemiBold"/>
                                    </StackPanel>

                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="Город:" 
                                                  FontSize="14"
                                                  FontWeight="SemiBold"
                                                  Foreground="{StaticResource TextColor}"
                                                  Margin="0,5,10,5"
                                                  Width="150"/>
                                        <TextBlock x:Name="CityTextBlock" 
                                                  FontSize="14"
                                                  Foreground="{StaticResource TextColor}"
                                                  Margin="0,5,0,5"
                                                  TextWrapping="Wrap"/>
                                    </StackPanel>

                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="Организатор:" 
                                                  FontSize="14"
                                                  FontWeight="SemiBold"
                                                  Foreground="{StaticResource TextColor}"
                                                  Margin="0,5,10,5"
                                                  Width="150"/>
                                        <TextBlock x:Name="OrganizerTextBlock" 
                                                  FontSize="14"
                                                  Foreground="{StaticResource TextColor}"
                                                  Margin="0,5,0,5"
                                                  TextWrapping="Wrap"/>
                                    </StackPanel>

                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="Длительность:" 
                                                  FontSize="14"
                                                  FontWeight="SemiBold"
                                                  Foreground="{StaticResource TextColor}"
                                                  Margin="0,5,10,5"
                                                  Width="150"/>
                                        <TextBlock x:Name="DurationTextBlock" 
                                                  FontSize="14"
                                                  Foreground="{StaticResource TextColor}"
                                                  Margin="0,5,0,5"
                                                  TextWrapping="Wrap"/>
                                    </StackPanel>
                                </StackPanel>
                            </Grid>
                        </StackPanel>
                    </Border>

                    <!-- Описание -->
                    <TextBlock Text="Описание мероприятия" 
                              FontSize="18"
                              FontWeight="Bold"
                              Foreground="{StaticResource AccentColor}"
                              Margin="0,20,0,10"/>

                    <Border Background="#F8F8F8"
                            BorderBrush="{StaticResource BorderColor}"
                            BorderThickness="1"
                            CornerRadius="6"
                            Padding="15"
                            Margin="0,0,0,10">
                        <TextBlock x:Name="DescriptionTextBlock"
                                  FontSize="14"
                                  Foreground="{StaticResource TextColor}"
                                  TextWrapping="Wrap"/>
                    </Border>
                </StackPanel>

                <!-- Правая панель: действия и активности -->
                <StackPanel Grid.Column="1">
                    <!-- Панель действий -->
                    <Border Background="#F8F8F8"
                            BorderBrush="{StaticResource BorderColor}"
                            BorderThickness="1"
                            CornerRadius="6"
                            Padding="15"
                            Margin="0,0,0,15">
                        <StackPanel>
                            <TextBlock Text="Действия"
                                      FontWeight="Bold"
                                      FontSize="16"
                                      Margin="0,0,0,10"
                                      Foreground="{StaticResource AccentColor}"/>

                            <!-- Для участников -->
                            <StackPanel x:Name="ParticipantActionsPanel"
                                      Visibility="Collapsed">
                                <Button x:Name="RegisterButton"
                                        Content="Зарегистрироваться на мероприятие"
                                        Style="{StaticResource ActionButtonStyle}"
                                        Click="RegisterButton_Click"
                                        Background="{StaticResource SuccessColor}"
                                        Foreground="White"/>

                                <Button x:Name="CancelRegistrationButton"
                                        Content="Отменить регистрацию"
                                        Style="{StaticResource ActionButtonStyle}"
                                        Click="CancelRegistrationButton_Click"
                                        Background="{StaticResource ErrorColor}"
                                        Foreground="White"
                                        Visibility="Collapsed"/>

                                <TextBlock x:Name="RegistrationInfoText"
                                          FontSize="12"
                                          Foreground="{StaticResource SecondaryTextColor}"
                                          Margin="0,10,0,0"
                                          TextWrapping="Wrap"/>
                            </StackPanel>

                            <!-- Для модераторов -->
                            <StackPanel x:Name="ModeratorActionsPanel"
                                      Visibility="Collapsed">
                                <TextBlock Text="Выберите активность для модерации:"
                                          FontSize="13"
                                          Foreground="{StaticResource TextColor}"
                                          Margin="0,0,0,5"/>

                                <ComboBox x:Name="ModeratorActivitiesComboBox"
                                          Style="{StaticResource ComboBoxStyle}"
                                          DisplayMemberPath="activity_name">
                                    <ComboBox.ToolTip>
                                        <ToolTip>
                                            Выберите активность для модерации
                                            (на одну активность может быть только один модератор)
                                        </ToolTip>
                                    </ComboBox.ToolTip>
                                </ComboBox>

                                <Button x:Name="RegisterAsModeratorButton"
                                        Content="Зарегистрироваться как модератор"
                                        Style="{StaticResource ActionButtonStyle}"
                                        Click="RegisterAsModeratorButton_Click"
                                        Background="{StaticResource WarningColor}"
                                        Foreground="White"/>
                            </StackPanel>

                            <!-- Для жюри -->
                            <StackPanel x:Name="JuryActionsPanel"
                                      Visibility="Collapsed">
                                <TextBlock Text="Выберите активность для оценки:"
                                          FontSize="13"
                                          Foreground="{StaticResource TextColor}"
                                          Margin="0,0,0,5"/>

                                <ComboBox x:Name="JuryActivitiesComboBox"
                                          Style="{StaticResource ComboBoxStyle}"
                                          DisplayMemberPath="activity_name">
                                    <ComboBox.ToolTip>
                                        <ToolTip>
                                            Выберите активность для оценки как жюри
                                            (на одну активность может быть несколько жюри)
                                        </ToolTip>
                                    </ComboBox.ToolTip>
                                </ComboBox>

                                <Button x:Name="RegisterAsJuryButton"
                                        Content="Добавить активность для оценки"
                                        Style="{StaticResource ActionButtonStyle}"
                                        Click="RegisterAsJuryButton_Click"
                                        Background="{StaticResource AccentColor}"
                                        Foreground="White"/>

                                <TextBlock Text="Ваши активности для оценки:"
                                          FontSize="13"
                                          FontWeight="SemiBold"
                                          Foreground="{StaticResource TextColor}"
                                          Margin="0,15,0,5"/>

                                <ListBox x:Name="SelectedJuryActivitiesListBox"
                                         Style="{StaticResource ListBoxStyle}"
                                         DisplayMemberPath="activity_name">
                                    <ListBox.ToolTip>
                                        <ToolTip>
                                            Список активностей, на которые вы зарегистрированы как жюри
                                        </ToolTip>
                                    </ListBox.ToolTip>
                                </ListBox>

                                <Button x:Name="RemoveJuryActivityButton"
                                        Content="Удалить выбранную активность"
                                        Style="{StaticResource ActionButtonStyle}"
                                        Click="RemoveJuryActivityButton_Click"
                                        Background="{StaticResource ErrorColor}"
                                        Foreground="White"/>
                            </StackPanel>

                            <!-- Для гостей -->
                            <StackPanel x:Name="GuestActionsPanel"
                                      Visibility="Visible">
                                <TextBlock Text="Для участия в мероприятии необходимо войти в систему."
                                          FontSize="13"
                                          Foreground="{StaticResource SecondaryTextColor}"
                                          Margin="0,0,0,10"
                                          TextWrapping="Wrap"/>

                                <Button x:Name="LoginForActionsButton"
                                        Content="Войти для участия"
                                        Style="{StaticResource ActionButtonStyle}"
                                        Click="LoginForActionsButtonClick"
                                        Background="{StaticResource SecondaryBackground}"
                                        Foreground="{StaticResource TextColor}"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>

                    <!-- Активности мероприятия -->
                    <TextBlock Text="Активности мероприятия" 
                              FontSize="18"
                              FontWeight="Bold"
                              Foreground="{StaticResource AccentColor}"
                              Margin="0,0,0,10"/>

                    <Border Background="#F8F8F8"
                            BorderBrush="{StaticResource BorderColor}"
                            BorderThickness="1"
                            CornerRadius="6"
                            Padding="15"
                            Height="400"
                            Margin="0,0,0,10">
                        <ScrollViewer VerticalScrollBarVisibility="Auto">
                            <ItemsControl x:Name="ActivitiesItemsControl">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border Background="#F0F0F0"
                                                CornerRadius="6"
                                                Padding="10"
                                                Margin="0,0,0,10">
                                            <StackPanel>
                                                <TextBlock Text="{Binding activity_name}"
                                                          FontWeight="SemiBold"
                                                          FontSize="14"
                                                          Margin="0,0,0,5"/>

                                                <StackPanel Orientation="Horizontal">
                                                    <TextBlock FontSize="12"
                                                              Margin="0,0,10,0">
                                                        <TextBlock.Text>
                                                            <MultiBinding StringFormat="День {0}">
                                                                <Binding Path="activity_day"/>
                                                            </MultiBinding>
                                                        </TextBlock.Text>
                                                    </TextBlock>
                                                    <TextBlock FontSize="12">
                                                        <TextBlock.Text>
                                                            <MultiBinding StringFormat="Время: {0:hh\:mm}">
                                                                <Binding Path="start_time"/>
                                                            </MultiBinding>
                                                        </TextBlock.Text>
                                                    </TextBlock>
                                                </StackPanel>

                                                <TextBlock Text="{Binding description}"
                                                          FontSize="12"
                                                          Foreground="{StaticResource SecondaryTextColor}"
                                                          Margin="0,5,0,0"
                                                          TextWrapping="Wrap"/>
                                            </StackPanel>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </ScrollViewer>
                    </Border>
                </StackPanel>
            </Grid>
        </ScrollViewer>
    </Grid>
</Page>